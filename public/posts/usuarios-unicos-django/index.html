<!DOCTYPE html>
<html lang="es">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>Nombres de Usuarios Únicos en Django :: Alitux</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Cómo crear nombres de usuarios autogenerados únicos en Django: Generá un nombre combinando datos del usuario o strings aleatorios y chequeá en la base de datos que no exista. Si ya está tomado, modificalo hasta que sea único antes de guardar el usuario." />
<meta name="keywords" content=", " />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/posts/usuarios-unicos-django/" />





  
  <link rel="stylesheet" href="http://localhost:1313/css/terminal-retro.min.b28842aa78c9f2edfc14460e8ddea15c613a4b7c23f2de00dc0a4c42acb4f40a.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="http://localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="alituxtdf" />



<meta property="og:locale" content="es" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Nombres de Usuarios Únicos en Django">
<meta property="og:description" content="Cómo crear nombres de usuarios autogenerados únicos en Django: Generá un nombre combinando datos del usuario o strings aleatorios y chequeá en la base de datos que no exista. Si ya está tomado, modificalo hasta que sea único antes de guardar el usuario." />
<meta property="og:url" content="http://localhost:1313/posts/usuarios-unicos-django/" />
<meta property="og:site_name" content="Alitux" />

  
  
  <meta property="og:image" content="http://localhost:1313/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2024-01-13 11:19:13 -0300 -03" />












</head>
<body>


<div class="container full">

  <header class="header">
    <link rel="icon" href="../../favicon.png" type="image/png" />
    <div class="header__inner">
        <div class="header__logo">
            <a href="../../">
  <div class="logo">
    Alitux
  </div>
</a>

        </div>
        
        <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="../../acerca-de">De mí</a></li>
        
      
        
          <li><a href="../../cv">CV</a></li>
        
      
        
          <li><a href="../../contacto">Contacto</a></li>
        
      
      
    </ul>
  </li>
</ul>

        
        
    </div>
    
    <p class="site-subtitle">Python, Odoo, Linux y DevOps con filosofía de Software Libre</p>
    
    
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="../../acerca-de" >De mí</a></li>
        
      
        
          <li><a href="../../cv" >CV</a></li>
        
      
        
          <li><a href="../../contacto" >Contacto</a></li>
        
      
      
    
  </ul>
</nav>

    
</header>

  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/posts/usuarios-unicos-django/">Nombres de Usuarios Únicos en Django</a>
  </h1>
  <div class="post-meta"><time class="post-date">13-01-2024&nbsp;[Updated:  13-01-2024]</time><span class="post-author">Alitux</span><span class="post-reading-time">1 minutos de lectura (207 palabras)</span></div>

  
    <span class="post-tags">
      
      #<a href="http://localhost:1313/tags/django/">Django</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/python/">Python</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>La creación de nombres de usuarios autogenerados en Django no está implementada por defecto. Es por eso que escribí una simple función, que valiéndose de un CustomUser (No uso User por defecto ya que tengo un modelo personalizado que hereda sus propiedades desde AbstractUser) y tomando como entrada el primer nombre genera nombres de usuarios únicos no predecibles. Si bien no evita ataques por fuerza bruta, mitiga el uso de diccionarios con patrones comunes.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">unique_username</span><span class="p">(</span><span class="n">first_name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Función para generar username únicos en base al primer nombre
</span></span></span><span class="line"><span class="cl"><span class="s2">     
</span></span></span><span class="line"><span class="cl"><span class="s2">    Parameters:
</span></span></span><span class="line"><span class="cl"><span class="s2">     
</span></span></span><span class="line"><span class="cl"><span class="s2">    Keyword arguments:
</span></span></span><span class="line"><span class="cl"><span class="s2">    first_name
</span></span></span><span class="line"><span class="cl"><span class="s2">    Return: username
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">first_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="sa">r</span><span class="s2">&#34;([^n\u0300-\u036f]|n(?!\u0303(?![\u0300-\u036f])))[\u0300-\u036f]+&#34;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&#34;\1&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">normalize</span><span class="p">(</span> <span class="s2">&#34;NFD&#34;</span><span class="p">,</span> <span class="n">first_name</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">first_name</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span> <span class="s1">&#39;NFC&#39;</span><span class="p">,</span> <span class="n">first_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">CustomUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">first_name</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">first_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">CustomUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">first_name</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">first_name</span> <span class="o">=</span> <span class="n">first_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())[:</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">first_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span></code></pre></div><p>La implementación dentro de una vista FormView queda como sigue:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SocioCreateView</span><span class="p">(</span><span class="n">LoginRequiredMixin</span><span class="p">,</span> <span class="n">AdminORAdministrativoRequiredMixin</span><span class="p">,</span> <span class="n">FormView</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Vista Para crear Socios desde una cuenta admin o Administrativa
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">     
</span></span><span class="line"><span class="cl">    <span class="n">form_class</span> <span class="o">=</span> <span class="n">NuevoUsuarioForm</span>
</span></span><span class="line"><span class="cl">    <span class="n">template_name</span> <span class="o">=</span> <span class="s2">&#34;home/sections/administrador/socio_create.html&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s2">&#34;admin_socio_list&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1">### Creación de Usuario</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="o">=</span> <span class="n">CustomUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">first_name</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">last_name</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">email</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">username</span><span class="o">=</span><span class="n">unique_username</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">            <span class="n">password</span><span class="o">=</span><span class="n">make_password</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">            <span class="n">dni</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">genero</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;genero&#39;</span><span class="p">],</span>      
</span></span><span class="line"><span class="cl">            <span class="n">direccion</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;direccion&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">ciudad</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;ciudad&#39;</span><span class="p">],</span>      
</span></span><span class="line"><span class="cl">            <span class="n">provincia</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;provincia&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">pais</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;pais&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">telefono</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;telefono&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">fecha_nacimiento</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;fecha_nacimiento&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span></code></pre></div><p>Yo la implementé dentro de una vista, pero tranquilamente se podría utilizar en el modelo o como un validador para un Form.</p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Leer otros posteos</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="http://localhost:1313/posts/tuneles-cloudflare-raspberry-pi/" class="button inline prev">
        &lt; [<span class="button__text">Tuneles Cloudflare en una Raspberry Pi</span>]
      </a>
    
    
      ::
    
    
      <a href="http://localhost:1313/posts/despliegue-basico-django-docker-traefik-cloudflare/" class="button inline next">
         [<span class="button__text">Despliegue básico de Django con Docker, Traefik y CloudFlare</span>] &gt;
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
    <div class="footer__inner">
        
        <div class="copyright copyright--user">
            <span>Copyleft 2025. Nothing reserved. Feel free to share and share alike.</span>
            
            </div>
        </div>
</footer>






<script type="text/javascript" src="../../bundle.min.js"></script>




  
</div>

</body>
</html>
